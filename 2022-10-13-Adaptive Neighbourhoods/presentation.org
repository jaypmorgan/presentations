#+title: Adaptive Neighbourhoods for the Discovery of Adversarial Examples
#+author: Jay Morgan, University of Toulon
#+email: jay.morgan@univ-tln.fr
#+date: 13th October 2022
#+startup: beamer
#+options: H:2 toc:nil
#+latex_header: \usepackage{tikz}
#+latex_header: \usepackage{tabularx,booktabs,multirow,adjustbox}
#+latex_header: \usefonttheme{serif}
#+latex_class: beamer
#+latex_class_options: [smaller]
#+BIBLIOGRAPHY: ./references.bib
#+COLUMNS: %40ITEM %10BEAMER_env(Env) %9BEAMER_envargs(Env Args) %4BEAMER_col(Col) %10BEAMER_extra(Extra)

* Introduction

** A thank you to my collaborators

*** Adeline                                                           :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.3
:END:
#+ATTR_LATEX: :width 0.7\textwidth
[[file:images/Adeline-Paiement.jpg]]
\begin{center}
Adeline Paiement

University of Toulon
\end{center}
*** Arno                                                              :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.3
:END:
#+ATTR_LATEX: :width 0.7\textwidth
[[file:images/Arno-Pauly.jpg]]
\begin{center}
Arno Pauly

Swansea University
\end{center}
*** Monika                                                            :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.3
:END:
#+ATTR_LATEX: :width 0.7\textwidth
[[file:images/Monika-Seisenberger.jpg]]
\begin{center}
Monika Seisenberger

Swansea University
\end{center}

** Deep Neural Networks

[[file:images/Object-detection-in-a-dense-scene.jpg]]
[cite:@unknown]

** Adversarial Examples

[[file:images/fgsm_panda_image.png]]
[cite:@goodfellow2014explaining]

** Motivating Principles

[[file:images/signs.png]]
[cite:@huang2017safety]

* Adaptive Neighbourhoods

** Outline for this talk

1. Look at existing solutions
2. Our complimentary method
3. Some results on two tasks:
   - Iris Dataset
   - Solar Burst Detection
4. Some conclusions

** Fast Gradient Sign Method (FGSM)

[[file:images/fgsm_panda_image.png]]
[cite:@goodfellow2014explaining]

** Projected Gradient Descent (PGD)

[cite:@madry2017towards]

** Carlini & Wagner (C&W)

[cite:@carlini2017towards]

** What do we learn from these methods?

#+ATTR_LATEX: :width 0.5\textwidth
[[file:images/perturbation.png]]

** Amount of change is important

[[file:images/eos.png]]

** Non-image representations

#+ATTR_LATEX: :width 0.7\textwidth
[[file:images/iris.png]]

** Perturbations shouldn't pass class boundaries

\begin{figure}
    \centering
    \begin{tikzpicture}[scale=1.3]
        \draw [very thick,dotted] (-2,1.2) .. controls (0.8, 0.8) and (0.8,0) .. (2,-1.5);
        \filldraw [gray] (-0.2,-0.2) circle (3pt);
        \draw [->] (-0.5,-0.5) -- (0.6,0.6);
        \draw [->] (-0.5,-0.5) -- (-1,-1);
        \draw [thick] (-0.2,-0.2) circle (35pt);
        
        \node at (-0.05,-0.55) {$x_i$};
        \node at (-1.7, -0.2) {$\varepsilon$};
        \node[align=center] at (2.8, -0.5) {True class \\ boundary};
    \end{tikzpicture}
    \label{fig:complexity}
\end{figure}

\begin{center}
\vspace{2em}
Example where a data point $x_i$ lies close to the class decision boundary. In these
situations, too large $\varepsilon$ values, may push the synthetically generated
point over true class boundaries.
\end{center}

** Estimated boundaries can be deceiving

*** Figure 2                                                          :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\begin{figure}
    \centering
    \begin{tikzpicture}[scale=1.3]
	% nodes
	\draw (-1,0) circle (3pt);
	\filldraw [gray] (1,0) circle (3pt);

	%lines
	\draw (0, 1) -- (0,-1);
	\draw [dotted] (-0.9,1) -- (-0.9,-1);
	\draw [dotted] ( 0.9,1) -- ( 0.9,-1);
    \end{tikzpicture}
    \label{fig:density_a}
\end{figure}

\begin{center}
\vspace{2em}Sparse regions of the manifold may appear simple due to the lack of information.
\end{center}

*** Figure 3                                                          :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\begin{figure}
    \centering
    \begin{tikzpicture}[scale=1.3]
	% nodes
	\draw (-1,0) circle (3pt);
	\draw (0.5,0.9) circle (3pt);
	\draw (0.5,-0.9) circle (3pt);
	\filldraw [gray] (1,0) circle (3pt);

	%lines
	\draw (0.9, 1) .. controls (0.5,0) .. (0.9,-1);
	\draw [dotted] (1.1, 1) .. controls (0.7,0) .. (1.1,-1);
	\draw [dotted] (0.7, 1) .. controls (0.3,0) .. (0.7,-1);
    \end{tikzpicture}
    \label{fig:density_b}
\end{figure}


\begin{center}
\vspace{2em}More data points enable more precise estimation of the class boundary.
\end{center}

** Estimating Sparsity/Density

\begin{equation}
    \varphi(x; \overline{x}) =  \frac{1}{\sqrt{1 + (\varepsilon r)^2}},\; \text{where}\; r = \parallel \overline{x} - x \parallel
    \label{eq:rbf}
\end{equation}

\vspace{2em}

Providing the RBF's width parameter is suitably chosen, we achieve a good measure of
the density through the sum of the RBFs centred on all data points $X^c$ of class $c$
(Eq.~\ref{eq:density}).

\vspace{2em}

\begin{equation}
    \rho_c(x) = \sum_{x_j \in X^c} \varphi(x; x_j)
    \label{eq:density}
\end{equation}

** Expansion


\begin{figure}
    \centering
    \begin{tikzpicture}[scale=.8]
        \draw (0.4,0) node {$x_1$};
        \draw[dashed] (0,0) circle (1.0cm);
        \draw[dashed] (0,0) circle (1.45cm);
        \draw[thick,dotted] (0,0) circle (1.75cm);
        
        \draw[->]        (0.1,0) -- (-1.0,0) node[below,midway] {$\varepsilon_1$};
        \draw[->] (-1.0,0) -- (-1.45,0) node[below,midway] {};
        \draw[->] (-1.5,0) -- (-1.75,0) node[below,midway] {};
        \draw[thick, ->] (0.1,0) -- (-0.5,1.75) node[anchor=south] {$\varepsilon$};
        
        \draw (2.57,1) node {$x_2$};
        \draw[thick] (2.57,1) circle (1.0cm);
        
        \draw (2,-0.4) node {$x_3$};
        \draw[thick,dotted] (2,-0.4) circle (0.5cm);
    \end{tikzpicture}
\label{fig:e_expansion}
\end{figure}

\begin{center}
\vspace{2em}Iterative $\varepsilon$-expansion process in a binary class scenario. The
two classes are distinguished by the dotted and solid circles.\vspace{1em}
\end{center}

\begin{equation*}
    \Delta\varepsilon_i^n=e^{-\rho_{c(i)}(x_i) \cdot n}
    \label{eq:step}
\end{equation*}

* Results

** Iris Dataset

*** Problem statement                                                 :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.3
:END:

#+ATTR_ORG: :width 200px
#+ATTR_LATEX: :width 1.0\textwidth
[[file:images/Petal-sepal.jpg]]

*** Graph                                                             :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.7
:END:

#+ATTR_ORG: :width 200px

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{images/iris-eps.png}
    \label{fig:iris}
\end{figure}

[cite:@DBLP:journals/corr/abs-2101-09108]

** Defending against Adversarial Examples

\[
\mathcal{L}_{total} = (1 - \alpha) \mathcal{L}_{cls} + \alpha \mathcal{L}_{adv}
\]


\vspace{2em}

\begin{center}where \( \mathcal{L}_{cls} \) and \( \mathcal{L}_{adv} \) are the cross-entropy
losses of the un-perturbed and perturbed data, respectively.\end{center}

** Results

\begin{table}

\caption{\label{tab:irir_results}$F_1$ score of DNN for the Iris dataset using various adversarial defence methods. Scores are in the format: mean (standard deviation) over 10 k-folds. Bold font face indicates the best form of attack for each type of defence method.}
\centering
\begin{adjustbox}{center}
\resizebox{\textwidth}{!}{\begin{tabular}[t]{cccccc}
\toprule
\multicolumn{2}{c}{ } & \multicolumn{4}{c}{Attack} \\
\cmidrule(l{3pt}r{3pt}){3-6}
Defence & None & FGSM & PGD & FGSM+AN & PGD+AN\\
\midrule
None & 0.9745 (0.0413) & 0.9278 (0.0618) & 0.8572 (0.1036) & \textbf{0.7764 (0.0813)} & 0.8461 (0.0968)\\
FGSM & 0.9811 (0.0396) & 0.9408 (0.0757) & 0.8468 (0.1080) & \textbf{0.7873 (0.0785)} & 0.8448 (0.0698)\\
PGD & 0.9867 (0.0400) & 0.9462 (0.0740) & 0.8680 (0.0740) & \textbf{0.8508 (0.0746)} & 0.8759 (0.0823)\\
\midrule
Random+AN & 0.9936 (0.0193) & 0.9272 (0.0620) & 0.8274 (0.0918) & \textbf{0.7935 (0.0822)} & 0.8454 (0.0864)\\
FGSM+AN & 0.9936 (0.0193) & 0.9406 (0.0745) & 0.8420 (0.0987) & \textbf{0.8140 (0.1085)} & 0.8588 (0.1157)\\
PGD+AN & 0.9936 (0.0193) & 0.9472 (0.0642) & 0.9472 (0.0642) & \textbf{0.8679 (0.0899)} & 0.8753 (0.0864)\\
\bottomrule
\end{tabular}}
\end{adjustbox}
\end{table}


** Adversarial Training for Solar Burst Detection

\begin{figure}[t]
\centering
\resizebox{0.55\textwidth}{!}{\input{./images/adversarial_example}}
\label{fig:adv_example}
\end{figure}
[cite:@Solr-cronfa59258]

** Results

\begin{table}
\caption{\label{tab:adv_fscore}$F_1$ score performance on the WAVES dataset using Faster R-CNN. Numbers highlighted in a bold font face indicate the best achieving adversarial attack for each form of defence.}
\centering
\begin{adjustbox}{center}
\resizebox{\textwidth}{!}{\begin{tabular}[t]{rccccccc}
\toprule
\multicolumn{2}{c}{ } & \multicolumn{6}{c}{Attack} \\
\cmidrule(l{3pt}r{3pt}){3-8}
Defence & None & FGSM & FGSM+AN & PGD & PGD+AN & DAG & DAG+AN\\
\midrule
None & 0.568 & 0.539 & 0.486 & 0.198 & \textbf{0.105} & 0.399 & 0.251\\
FGSM & 0.463 & 0.458 & 0.178 & 0.013 & \textbf{0.012} & 0.055 & 0.028\\
FGSM+AN & 0.480 & 0.465 & 0.462 & \textbf{0.007} & \textbf{0.007} & 0.043 & 0.023\\
PGD & 0.421 & 0.425 & 0.379 & 0.391 & 0.359 & 0.378 & \textbf{0.259}\\
PGD+AN & 0.364 & 0.359 & 0.330 & 0.339 & 0.324 & 0.330 & \textbf{0.212}\\
\bottomrule
\end{tabular}}
\end{adjustbox}
\end{table}

* Conclusion

** Summary of Results

- Adaptive neighbourhoods is an effective method that compliments existing
  adversarial generation methods such as FGSM & PGD.
- Adaptive neighbourhoods performs better with optimisation-based procedures such as
  PGD.
- Through the use of adaptive neighbourhoods, one can meaningfully define searchable
  regions for datasets other than image-based data where adversarial examples can be
  visually inspected.

** Source code

#+ATTR_LATEX: :width 0.8\textwidth
[[file:images/github-repo.png]]

\begin{center}
\url{https://github.com/jaypmorgan/adaptive-neighbourhoods}
\url{https://gibtlab.com/jaymorgan/adaptive-neighbourhoods}
\url{https://git.sr.ht/~jaymorgan/adaptive-neighbourhoods}
\end{center}

** Link to the Slides

#+ATTR_LATEX: :width 1.0\textwidth
[[file:images/presentations.png]]

\begin{center}
\url{https://github.com/jaypmorgan/presentations}
\end{center}

** 
:PROPERTIES:
:BEAMER_OPT: plain,c
:END:

\begin{center}
\vspace{1em}\Huge Thank you!
\end{center}
** References

#+print_bibliography:
